import com.google.gson.Gson;

import java.util.HashMap;
import java.util.Map;

public class LinkedListDebug {

    private static final Map<Integer, Node> linkedList = new HashMap<>();
    private static int currentIndex = 0;
    private static boolean asc = true; //false for descending

//----------------------------------------------------
public static void putNode(int index, int previousIndex, int num){
    Node node = new Node();
    node.previousIndex = previousIndex;
    node.value = num;
    linkedList.put(index, node);
}
//----------------------------------------------------
    public static int getCurrentIndex(){
        return currentIndex;
    }

    public static void setCurrentIndex(int num){
        currentIndex = num;
    }

//----------------------------------------------------

    public static int getValueAt(int index){
        return linkedList.get(index).value;
    }

    public static void setValueAt(int index, int num){
        Node change = linkedList.get(index);
        change.value = num;
        putNode(index, change.previousIndex, change.value);
    }

    public int getPreviousIndexAt(int index){
        return linkedList.get(index).previousIndex;
    }

    public static void setPreviousIndexAt(int index, int num){
        Node change = linkedList.get(index);
        change.previousIndex = num;
        putNode(index, change.previousIndex, change.value);
    }

    //----------------------------------------------------
    public static void push(int index, int num){
        if((asc&&index<=currentIndex) || (!asc&&index>=currentIndex)){
            //don't do it, must remove first
        }
        else {
            putNode(index, currentIndex, num);
            currentIndex = index;
        }
    }

    public static void pop(){
        currentIndex = linkedList.get(currentIndex).previousIndex;
    }

    public static void insertAtAsc(int index, int num){
        if(linkedList.containsKey(index)) return; //must remove it first!
        if(currentIndex==index) return; //must remove it first!
        if(currentIndex<index){push(index,num); return;}

        int closestIndex = findClosestIndexAsc(index);
        putNode(index, linkedList.get(closestIndex).previousIndex, num);
        linkedList.get(closestIndex).previousIndex = index;
    }


    public static void remove(int index){
        if(!linkedList.containsKey(index) || index==0) return; //must exist!
        if(currentIndex==index) {pop(); return;}

        int pointerIndex = findPointerIndex(index);
        int skipToIndex = linkedList.get(index).previousIndex;
        linkedList.get(pointerIndex).previousIndex = skipToIndex;
    }

    private static int findPointerIndex(int index) {
        int atCurrent = currentIndex;
        int prev = linkedList.get(atCurrent).previousIndex;
        while(prev!=index){
            atCurrent = prev;
            prev = linkedList.get(atCurrent).previousIndex;
        }
        return atCurrent;
    }


    public static void truncateAt(int index){
        if(!linkedList.containsKey(index) || index==0 || index==currentIndex) return; //must exist!
        currentIndex = index;
    }

    public static int findClosestIndexAsc(int searchIndex){
        int atCurrent = currentIndex;
        int prev = linkedList.get(atCurrent).previousIndex;
        while(prev>searchIndex){
            atCurrent = prev;
            prev = linkedList.get(atCurrent).previousIndex;
        }
        return atCurrent;
    }



    public static void printList(){
        String out = ""+currentIndex;

        int iterator = currentIndex;
        while(iterator>0) {
            Node node = linkedList.get(iterator);
            int previousIndex = node.previousIndex;
            int value = node.value;
//            System.out.println(iterator + ":" + previousIndex + ":" + value);
            out = "{"+iterator + ":" + previousIndex + ":" + value+"}<--"+out;
            iterator = previousIndex;
        }
        out = "end<--"+out;

        System.out.println(out);
    }




    public static void main(String[] args){
        //setup
        Node first = new Node();
        first.previousIndex = (0);
        first.value = (0);
        linkedList.put(0,first);
        Gson gson = new Gson();
        //------------------------------

        push(1,1);
        push(3,5);
        push(5,6);
        push(7,9);
        push(9,9);
        printList();
        insertAtAsc(4,5);


        printList();




    }
}
class Node {
    public Integer previousIndex = null;
    public Integer value = null;
}
